### Демонстрация работы

[Смотреть демо](https://github.com/user-attachments/assets/15ceb7a2-9e37-48ce-9bbc-5cb5d8a13d78)

---

### Логика работы аукциона

1. Пользователь создаёт аукцион. Аукцион создается со статусом DRAFT (или SCHEDULED если указано время запуска).

2. Пользователь нажимает кнопку "Запустить аукцион" - аукцион переходит в статус ACTIVE. К аукциону подключаются 30 ботов которые делают ставки, стараясь не перебивать ставки реальных игроков.

3. Игроки делают ставки. При размещении ставки средства резервируются на балансе (не списываются сразу). Игрок не может сделать ставку ниже самой низкой призовой ставки, если все призовые места уже заняты.
Если оба игрока одновременно делают ставку с одинаковым номиналом и при этом обе ставки попадают в призы - то лидерство займёт ставка сделанная раньше (счёт на миллисекунды)

4. По истечению времени раунда определяются победители. Их зарезервированные средства списываются окончательно, начисляются подарки. Проигравшие ставки переносятся на следующий раунд вместе с резервом.

5. После последнего раунда все непобедившие ставки возвращаются - резерв снимается.

6. Anti-sniping (опционально при создании):
   - **Порог**: секунды до конца раунда, в течение которых ставки триггерят анти-снайпинг с последующим продлением (ставки ботов тоже триггерят анти-снайпинг)
   - **Продление**: секунды, на которые продлевается раунд
   - **Макс. продлений**: лимит продлений раунда по истечению которого - раунд больше не продлевается

---

### Архитектура бэкенда

#### Services
- `AuctionService` — создание, старт, завершение аукционов
- `RoundService` — управление раундами, определение победителей, перенос ставок
- `BidService` — размещение ставок, проверка anti-sniping, ранжирование
- `BalanceService` — резервирование, подтверждение, возврат средств, транзакции
- `BotService` — логика ботов-участников
- `AuctionScheduler` — автозапуск аукционов по расписанию, завершение раундов
- `SocketService` — Socket.IO, real-time обновления состояния аукциона

#### Storage
Слой работы с MongoDB. Коллекции: `user`, `auction`, `round`, `bid`, `gift`, `transaction`.

#### WebSocket события
- `join:auction` / `leave:auction` — подписка на аукцион
- `timer:update` — таймер раунда (каждую секунду)
- `bid:update` — обновление лидерборда при новой ставке
- `round:end` — окончание раунда с победителями
- `auction:end` — завершение аукциона

---

### Стэк
- Express.js
- MongoDB
- Socket.IO
- React + Vite

### Installation
```bash
docker-compose up --build #windows
sudo docker compose up --build #linux
```

---

Веб-сайт: https://snaplanding.ru (Если не работает - переходи по ip:port. Cloudflare в последнее время сбоит)

Документация Swagger (Rest, socket.io): https://snaplanding.ru/docs

Адрес сервера: http://64.188.68.112:3030

